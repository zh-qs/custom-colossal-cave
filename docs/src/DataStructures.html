<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">DataStructures</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Attoparsec.Text</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">type</span><span> </span><span id="Name"><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-var">Name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">type</span><span> </span><span id="ParamName"><span class="annot"><a href="DataStructures.html#ParamName"><span class="hs-identifier hs-var">ParamName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">type</span><span> </span><span id="Id"><span class="annot"><a href="DataStructures.html#Id"><span class="hs-identifier hs-var">Id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">type</span><span> </span><span id="ItemName"><span class="annot"><a href="DataStructures.html#ItemName"><span class="hs-identifier hs-var">ItemName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">type</span><span> </span><span id="Inventory"><span class="annot"><a href="DataStructures.html#Inventory"><span class="hs-identifier hs-var">Inventory</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataStructures.html#ItemName"><span class="hs-identifier hs-type">ItemName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-17"></span><span class="hs-keyword">type</span><span> </span><span id="Hand"><span class="annot"><a href="DataStructures.html#Hand"><span class="hs-identifier hs-var">Hand</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="DataStructures.html#ItemName"><span class="hs-identifier hs-type">ItemName</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">type</span><span> </span><span id="Visibility"><span class="annot"><a href="DataStructures.html#Visibility"><span class="hs-identifier hs-var">Visibility</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">type</span><span> </span><span id="StIO"><span class="annot"><a href="DataStructures.html#StIO"><span class="hs-identifier hs-var">StIO</span></a></span></span><span> </span><span id="local-6989586621679060621"><span class="annot"><a href="#local-6989586621679060621"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="DataStructures.html#Game"><span class="hs-identifier hs-type">Game</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679060621"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">type</span><span> </span><span id="Desc"><span class="annot"><a href="DataStructures.html#Desc"><span class="hs-identifier hs-var">Desc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-comment">-- |Stateful 'Parser' with a map of interactables already read and default room entry action as a state.</span><span>
</span><span id="line-24"></span><span class="hs-keyword">type</span><span> </span><span id="StParser"><span class="annot"><a href="DataStructures.html#StParser"><span class="hs-identifier hs-var">StParser</span></a></span></span><span> </span><span id="local-6989586621679060620"><span class="annot"><a href="#local-6989586621679060620"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="DataStructures.html#Interactable"><span class="hs-identifier hs-type">Interactable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="#local-6989586621679060620"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-- |Name a stateful 'Parser'. The lifted equivalent of '&lt;?&gt;' from attoparsec.</span><span>
</span><span id="line-27"></span><span id="local-6989586621679060759"><span class="annot"><a href="DataStructures.html#%3C%3F%3F%3E"><span class="hs-operator hs-type">(&lt;??&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#StParser"><span class="hs-identifier hs-type">StParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060759"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#StParser"><span class="hs-identifier hs-type">StParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060759"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-28"></span><span id="%3C%3F%3F%3E"><span class="annot"><span class="annottext">&lt;??&gt; :: forall a. StParser a -&gt; String -&gt; StParser a
</span><a href="DataStructures.html#%3C%3F%3F%3E"><span class="hs-operator hs-var hs-var">(&lt;??&gt;)</span></a></span></span><span> </span><span id="local-6989586621679060617"><span class="annot"><span class="annottext">StParser a
</span><a href="#local-6989586621679060617"><span class="hs-identifier hs-var">stp</span></a></span></span><span> </span><span id="local-6989586621679060616"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679060616"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Map String Interactable, Action ())
 -&gt; Parser Text (a, (Map String Interactable, Action ())))
-&gt; StParser a
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; StateT s m a
</span><span class="hs-identifier hs-var">StateT</span></span><span> </span><span class="annot"><span class="annottext">(((Map String Interactable, Action ())
  -&gt; Parser Text (a, (Map String Interactable, Action ())))
 -&gt; StParser a)
-&gt; ((Map String Interactable, Action ())
    -&gt; Parser Text (a, (Map String Interactable, Action ())))
-&gt; StParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679060614"><span class="annot"><span class="annottext">(Map String Interactable, Action ())
</span><a href="#local-6989586621679060614"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StParser a
-&gt; (Map String Interactable, Action ())
-&gt; Parser Text (a, (Map String Interactable, Action ()))
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><span class="hs-identifier hs-var hs-var">runStateT</span></span><span> </span><span class="annot"><span class="annottext">StParser a
</span><a href="#local-6989586621679060617"><span class="hs-identifier hs-var">stp</span></a></span><span> </span><span class="annot"><span class="annottext">(Map String Interactable, Action ())
</span><a href="#local-6989586621679060614"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text (a, (Map String Interactable, Action ()))
-&gt; String -&gt; Parser Text (a, (Map String Interactable, Action ()))
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679060616"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- |Representation of a command entered in a console by user</span><span>
</span><span id="line-31"></span><span class="hs-keyword">type</span><span> </span><span id="Command"><span class="annot"><a href="DataStructures.html#Command"><span class="hs-identifier hs-var">Command</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Visibility"><span class="hs-identifier hs-type">Visibility</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">data</span><span> </span><span id="Interactable"><span class="annot"><a href="DataStructures.html#Interactable"><span class="hs-identifier hs-var">Interactable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Item"><span class="annot"><a href="DataStructures.html#Item"><span class="hs-identifier hs-var">Item</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="longName"><span class="annot"><span class="annottext">Interactable -&gt; String
</span><a href="DataStructures.html#longName"><span class="hs-identifier hs-var hs-var">longName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span id="getDescription"><span class="annot"><span class="annottext">Interactable -&gt; Desc
</span><a href="DataStructures.html#getDescription"><span class="hs-identifier hs-var hs-var">getDescription</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Desc"><span class="hs-identifier hs-type">Desc</span></a></span><span class="hs-special">,</span><span> </span><span id="getCommands"><span class="annot"><span class="annottext">Interactable -&gt; [Command]
</span><a href="DataStructures.html#getCommands"><span class="hs-identifier hs-var hs-var">getCommands</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataStructures.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Entity"><span class="annot"><a href="DataStructures.html#Entity"><span class="hs-identifier hs-var">Entity</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getDescription"><span class="annot"><a href="DataStructures.html#getDescription"><span class="hs-identifier hs-var">getDescription</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Desc"><span class="hs-identifier hs-type">Desc</span></a></span><span class="hs-special">,</span><span> </span><span id="entityParameters"><span class="annot"><span class="annottext">Interactable -&gt; Map String Int
</span><a href="DataStructures.html#entityParameters"><span class="hs-identifier hs-var hs-var">entityParameters</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span id="getCommands"><span class="annot"><a href="DataStructures.html#getCommands"><span class="hs-identifier hs-var">getCommands</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataStructures.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Invalid"><span class="annot"><a href="DataStructures.html#Invalid"><span class="hs-identifier hs-var">Invalid</span></a></span></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679060600"><span id="local-6989586621679060603"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="DataStructures.html#Interactable"><span class="hs-identifier hs-type">Interactable</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-38"></span><span>    </span><span id="local-6989586621679060595"><span class="annot"><span class="annottext">show :: Interactable -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span id="local-6989586621679060593"><span class="annot"><span class="annottext">item :: Interactable
</span><a href="#local-6989586621679060593"><span class="hs-identifier hs-var">item</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Item"><span class="hs-identifier hs-type">Item</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Item(commands:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Command -&gt; String) -&gt; String -&gt; [Command] -&gt; String
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679060591"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679060591"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060590"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679060590"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060589"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679060589"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Action ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679060591"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679060590"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679060589"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interactable -&gt; [Command]
</span><a href="DataStructures.html#getCommands"><span class="hs-identifier hs-var hs-var">getCommands</span></a></span><span> </span><span class="annot"><span class="annottext">Interactable
</span><a href="#local-6989586621679060593"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span id="local-6989586621679060588"><span class="annot"><span class="annottext">entity :: Interactable
</span><a href="#local-6989586621679060588"><span class="hs-identifier hs-var">entity</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entity(commands:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Command -&gt; String) -&gt; String -&gt; [Command] -&gt; String
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679060587"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679060587"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060586"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679060586"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060585"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679060585"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Action ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679060587"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679060586"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679060585"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interactable -&gt; [Command]
</span><a href="DataStructures.html#getCommands"><span class="hs-identifier hs-var hs-var">getCommands</span></a></span><span> </span><span class="annot"><span class="annottext">Interactable
</span><a href="#local-6989586621679060588"><span class="hs-identifier hs-var">entity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">data</span><span> </span><span id="Room"><span class="annot"><a href="DataStructures.html#Room"><span class="hs-identifier hs-var">Room</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Room"><span class="annot"><a href="DataStructures.html#Room"><span class="hs-identifier hs-var">Room</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="description"><span class="annot"><span class="annottext">Room -&gt; Desc
</span><a href="DataStructures.html#description"><span class="hs-identifier hs-var hs-var">description</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Desc"><span class="hs-identifier hs-type">Desc</span></a></span><span class="hs-special">,</span><span> </span><span id="onEntry"><span class="annot"><span class="annottext">Room -&gt; Action ()
</span><a href="DataStructures.html#onEntry"><span class="hs-identifier hs-var hs-var">onEntry</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="interactables"><span class="annot"><span class="annottext">Room -&gt; [String]
</span><a href="DataStructures.html#interactables"><span class="hs-identifier hs-var hs-var">interactables</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="roomCommands"><span class="annot"><span class="annottext">Room -&gt; [Command]
</span><a href="DataStructures.html#roomCommands"><span class="hs-identifier hs-var hs-var">roomCommands</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataStructures.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679060575"><span id="local-6989586621679060578"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="DataStructures.html#Room"><span class="hs-identifier hs-type">Room</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>    </span><span id="local-6989586621679060573"><span class="annot"><span class="annottext">show :: Room -&gt; String
</span><a href="#local-6989586621679060573"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span id="local-6989586621679060572"><span class="annot"><span class="annottext">Room
</span><a href="#local-6989586621679060572"><span class="hs-identifier hs-var">room</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Room(items:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; ShowS) -&gt; String -&gt; [String] -&gt; String
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679060571"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679060571"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679060570"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679060570"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679060571"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679060570"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Room -&gt; [String]
</span><a href="DataStructures.html#interactables"><span class="hs-identifier hs-var hs-var">interactables</span></a></span><span> </span><span class="annot"><span class="annottext">Room
</span><a href="#local-6989586621679060572"><span class="hs-identifier hs-var">room</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- |Structure that holds player parameters and items currently toting.</span><span>
</span><span id="line-47"></span><span class="hs-keyword">data</span><span> </span><span id="Player"><span class="annot"><a href="DataStructures.html#Player"><span class="hs-identifier hs-var">Player</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Player"><span class="annot"><a href="DataStructures.html#Player"><span class="hs-identifier hs-var">Player</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="playerParameters"><span class="annot"><span class="annottext">Player -&gt; Map String Int
</span><a href="DataStructures.html#playerParameters"><span class="hs-identifier hs-var hs-var">playerParameters</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span id="playerInventory"><span class="annot"><span class="annottext">Player -&gt; [String]
</span><a href="DataStructures.html#playerInventory"><span class="hs-identifier hs-var hs-var">playerInventory</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Inventory"><span class="hs-identifier hs-type">Inventory</span></a></span><span class="hs-special">,</span><span> </span><span id="leftHand"><span class="annot"><span class="annottext">Player -&gt; Hand
</span><a href="DataStructures.html#leftHand"><span class="hs-identifier hs-var hs-var">leftHand</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Hand"><span class="hs-identifier hs-type">Hand</span></a></span><span class="hs-special">,</span><span> </span><span id="rightHand"><span class="annot"><span class="annottext">Player -&gt; Hand
</span><a href="DataStructures.html#rightHand"><span class="hs-identifier hs-var hs-var">rightHand</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Hand"><span class="hs-identifier hs-type">Hand</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060548"><span id="local-6989586621679060550"><span id="local-6989586621679060563"><span class="annot"><span class="annottext">Int -&gt; Player -&gt; ShowS
[Player] -&gt; ShowS
Player -&gt; String
(Int -&gt; Player -&gt; ShowS)
-&gt; (Player -&gt; String) -&gt; ([Player] -&gt; ShowS) -&gt; Show Player
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Player] -&gt; ShowS
$cshowList :: [Player] -&gt; ShowS
show :: Player -&gt; String
$cshow :: Player -&gt; String
showsPrec :: Int -&gt; Player -&gt; ShowS
$cshowsPrec :: Int -&gt; Player -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060514"><span id="local-6989586621679060538"><span id="local-6989586621679060541"><span id="local-6989586621679060543"><span class="annot"><span class="annottext">ReadPrec [Player]
ReadPrec Player
Int -&gt; ReadS Player
ReadS [Player]
(Int -&gt; ReadS Player)
-&gt; ReadS [Player]
-&gt; ReadPrec Player
-&gt; ReadPrec [Player]
-&gt; Read Player
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Player]
$creadListPrec :: ReadPrec [Player]
readPrec :: ReadPrec Player
$creadPrec :: ReadPrec Player
readList :: ReadS [Player]
$creadList :: ReadS [Player]
readsPrec :: Int -&gt; ReadS Player
$creadsPrec :: Int -&gt; ReadS Player
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- |Structure that holds all information and state of the game.</span><span>
</span><span id="line-50"></span><span class="hs-keyword">data</span><span> </span><span id="Game"><span class="annot"><a href="DataStructures.html#Game"><span class="hs-identifier hs-var">Game</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Game"><span class="annot"><a href="DataStructures.html#Game"><span class="hs-identifier hs-var">Game</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span>
</span><span id="line-51"></span><span>    </span><span id="player"><span class="annot"><span class="annottext">Game -&gt; Player
</span><a href="DataStructures.html#player"><span class="hs-identifier hs-var hs-var">player</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-52"></span><span>    </span><span id="initialMessage"><span class="annot"><span class="annottext">Game -&gt; String
</span><a href="DataStructures.html#initialMessage"><span class="hs-identifier hs-var hs-var">initialMessage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-53"></span><span>    </span><span id="finalMessage"><span class="annot"><span class="annottext">Game -&gt; Desc
</span><a href="DataStructures.html#finalMessage"><span class="hs-identifier hs-var hs-var">finalMessage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Desc"><span class="hs-identifier hs-type">Desc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span id="globalOnEntry"><span class="annot"><span class="annottext">Game -&gt; Action ()
</span><a href="DataStructures.html#globalOnEntry"><span class="hs-identifier hs-var hs-var">globalOnEntry</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-55"></span><span>    </span><span id="globalRoomCommands"><span class="annot"><span class="annottext">Game -&gt; [Command]
</span><a href="DataStructures.html#globalRoomCommands"><span class="hs-identifier hs-var hs-var">globalRoomCommands</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataStructures.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-56"></span><span>    </span><span id="globalItemCommands"><span class="annot"><span class="annottext">Game -&gt; String -&gt; [Command]
</span><a href="DataStructures.html#globalItemCommands"><span class="hs-identifier hs-var hs-var">globalItemCommands</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#ItemName"><span class="hs-identifier hs-type">ItemName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataStructures.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span id="commandCount"><span class="annot"><span class="annottext">Game -&gt; Int
</span><a href="DataStructures.html#commandCount"><span class="hs-identifier hs-var hs-var">commandCount</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span id="rooms"><span class="annot"><span class="annottext">Game -&gt; Map String Room
</span><a href="DataStructures.html#rooms"><span class="hs-identifier hs-var hs-var">rooms</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="DataStructures.html#Room"><span class="hs-identifier hs-type">Room</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-59"></span><span>    </span><span id="currentRoomName"><span class="annot"><span class="annottext">Game -&gt; String
</span><a href="DataStructures.html#currentRoomName"><span class="hs-identifier hs-var hs-var">currentRoomName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-60"></span><span>    </span><span id="globalNameMap"><span class="annot"><span class="annottext">Game -&gt; Map String Interactable
</span><a href="DataStructures.html#globalNameMap"><span class="hs-identifier hs-var hs-var">globalNameMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="DataStructures.html#Interactable"><span class="hs-identifier hs-type">Interactable</span></a></span><span> </span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">}</span><span> </span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- |Encapsulates a 'StIO a' monad with an ability of immediate termination of a flow.</span><span>
</span><span id="line-64"></span><span class="hs-keyword">newtype</span><span> </span><span id="Action"><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-var">Action</span></a></span></span><span> </span><span id="local-6989586621679060717"><span class="annot"><a href="#local-6989586621679060717"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Action"><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-var">Action</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="fromAction"><span class="annot"><span class="annottext">forall a. Action a -&gt; StIO (Either String a)
</span><a href="DataStructures.html#fromAction"><span class="hs-identifier hs-var hs-var">fromAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#StIO"><span class="hs-identifier hs-type">StIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679060717"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679060490"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-67"></span><span>    </span><span id="local-6989586621679060482"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; Action a -&gt; Action b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679060481"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679060481"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span id="local-6989586621679060480"><span class="annot"><span class="annottext">StIO (Either String a)
</span><a href="#local-6989586621679060480"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StIO (Either String b) -&gt; Action b
forall a. StIO (Either String a) -&gt; Action a
</span><a href="DataStructures.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="annot"><span class="annottext">(StIO (Either String b) -&gt; Action b)
-&gt; StIO (Either String b) -&gt; Action b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Either String a -&gt; Either String b)
-&gt; StIO (Either String a) -&gt; StIO (Either String b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Either String a -&gt; Either String b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679060481"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StIO (Either String a)
</span><a href="#local-6989586621679060480"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679060470"><span id="local-6989586621679060472"><span id="local-6989586621679060474"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-70"></span><span>    </span><span id="local-6989586621679060463"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; Action a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StIO (Either String a) -&gt; Action a
forall a. StIO (Either String a) -&gt; Action a
</span><a href="DataStructures.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="annot"><span class="annottext">(StIO (Either String a) -&gt; Action a)
-&gt; (a -&gt; StIO (Either String a)) -&gt; a -&gt; Action a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO (Either String a) -&gt; StIO (Either String a)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either String a) -&gt; StIO (Either String a))
-&gt; (a -&gt; IO (Either String a)) -&gt; a -&gt; StIO (Either String a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either String a -&gt; IO (Either String a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either String a -&gt; IO (Either String a))
-&gt; (a -&gt; Either String a) -&gt; a -&gt; IO (Either String a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either String a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span id="local-6989586621679060453"><span class="annot"><span class="annottext">StIO (Either String (a -&gt; b))
</span><a href="#local-6989586621679060453"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679060452"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. Action (a -&gt; b) -&gt; Action a -&gt; Action b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*&gt;</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span id="local-6989586621679060451"><span class="annot"><span class="annottext">StIO (Either String a)
</span><a href="#local-6989586621679060451"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StIO (Either String b) -&gt; Action b
forall a. StIO (Either String a) -&gt; Action a
</span><a href="DataStructures.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="annot"><span class="annottext">(StIO (Either String b) -&gt; Action b)
-&gt; StIO (Either String b) -&gt; Action b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-72"></span><span>        </span><span id="local-6989586621679060450"><span class="annot"><span class="annottext">Either String (a -&gt; b)
</span><a href="#local-6989586621679060450"><span class="hs-identifier hs-var">ef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StIO (Either String (a -&gt; b))
</span><a href="#local-6989586621679060453"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-73"></span><span>        </span><span id="local-6989586621679060449"><span class="annot"><span class="annottext">Either String a
</span><a href="#local-6989586621679060449"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StIO (Either String a)
</span><a href="#local-6989586621679060451"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-74"></span><span>        </span><span class="annot"><span class="annottext">Either String b -&gt; StIO (Either String b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either String b -&gt; StIO (Either String b))
-&gt; Either String b -&gt; StIO (Either String b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Either String (a -&gt; b)
</span><a href="#local-6989586621679060450"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">Either String (a -&gt; b) -&gt; Either String a -&gt; Either String b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either String a
</span><a href="#local-6989586621679060449"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679060444"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679060440"><span class="annot"><span class="annottext">return :: forall a. a -&gt; Action a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">return</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Action a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span id="local-6989586621679060434"><span class="annot"><span class="annottext">StIO (Either String a)
</span><a href="#local-6989586621679060434"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679060433"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. Action a -&gt; (a -&gt; Action b) -&gt; Action b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621679060432"><span class="annot"><span class="annottext">a -&gt; Action b
</span><a href="#local-6989586621679060432"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StIO (Either String b) -&gt; Action b
forall a. StIO (Either String a) -&gt; Action a
</span><a href="DataStructures.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="annot"><span class="annottext">(StIO (Either String b) -&gt; Action b)
-&gt; StIO (Either String b) -&gt; Action b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StIO (Either String a)
</span><a href="#local-6989586621679060434"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">StIO (Either String a)
-&gt; (Either String a -&gt; StIO (Either String b))
-&gt; StIO (Either String b)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StIO (Either String b))
-&gt; (a -&gt; StIO (Either String b))
-&gt; Either String a
-&gt; StIO (Either String b)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO (Either String b) -&gt; StIO (Either String b)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either String b) -&gt; StIO (Either String b))
-&gt; (String -&gt; IO (Either String b))
-&gt; String
-&gt; StIO (Either String b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either String b -&gt; IO (Either String b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either String b -&gt; IO (Either String b))
-&gt; (String -&gt; Either String b) -&gt; String -&gt; IO (Either String b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Action b -&gt; StIO (Either String b)
forall a. Action a -&gt; StIO (Either String a)
</span><a href="DataStructures.html#fromAction"><span class="hs-identifier hs-var hs-var">fromAction</span></a></span><span> </span><span class="annot"><span class="annottext">(Action b -&gt; StIO (Either String b))
-&gt; (a -&gt; Action b) -&gt; a -&gt; StIO (Either String b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Action b
</span><a href="#local-6989586621679060432"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679060423"><span id="local-6989586621679060425"><span class="annot"><span class="hs-identifier hs-type">Alternative</span></span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621679060418"><span class="annot"><span class="annottext">empty :: forall a. Action a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StIO (Either String a) -&gt; Action a
forall a. StIO (Either String a) -&gt; Action a
</span><a href="DataStructures.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="annot"><span class="annottext">(StIO (Either String a) -&gt; Action a)
-&gt; StIO (Either String a) -&gt; Action a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO (Either String a) -&gt; StIO (Either String a)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either String a) -&gt; StIO (Either String a))
-&gt; IO (Either String a) -&gt; StIO (Either String a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Either String a -&gt; IO (Either String a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either String a -&gt; IO (Either String a))
-&gt; Either String a -&gt; IO (Either String a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span id="local-6989586621679060414"><span class="annot"><span class="annottext">StIO (Either String a)
</span><a href="#local-6989586621679060414"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679060413"><span class="annot"><span class="annottext">&lt;|&gt; :: forall a. Action a -&gt; Action a -&gt; Action a
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;|&gt;</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span id="local-6989586621679060411"><span class="annot"><span class="annottext">StIO (Either String a)
</span><a href="#local-6989586621679060411"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StIO (Either String a) -&gt; Action a
forall a. StIO (Either String a) -&gt; Action a
</span><a href="DataStructures.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="annot"><span class="annottext">(StIO (Either String a) -&gt; Action a)
-&gt; StIO (Either String a) -&gt; Action a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StIO (Either String a)
</span><a href="#local-6989586621679060414"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">StIO (Either String a)
-&gt; (Either String a -&gt; StIO (Either String a))
-&gt; StIO (Either String a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StIO (Either String a))
-&gt; (a -&gt; StIO (Either String a))
-&gt; Either String a
-&gt; StIO (Either String a)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StIO (Either String a) -&gt; String -&gt; StIO (Either String a)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">StIO (Either String a)
</span><a href="#local-6989586621679060411"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StIO (Either String a) -&gt; a -&gt; StIO (Either String a)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">StIO (Either String a)
</span><a href="#local-6989586621679060414"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621679060402"><span class="annot"><span class="annottext">liftIO :: forall a. IO a -&gt; Action a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">liftIO</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StIO a -&gt; Action a
forall a. StIO a -&gt; Action a
</span><a href="DataStructures.html#perform"><span class="hs-identifier hs-var">perform</span></a></span><span> </span><span class="annot"><span class="annottext">(StIO a -&gt; Action a) -&gt; (IO a -&gt; StIO a) -&gt; IO a -&gt; Action a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; StIO a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- |Lift 'StIO' to an 'Action'.</span><span>
</span><span id="line-88"></span><span id="local-6989586621679060653"><span class="annot"><a href="DataStructures.html#perform"><span class="hs-identifier hs-type">perform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#StIO"><span class="hs-identifier hs-type">StIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060653"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060653"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-89"></span><span id="perform"><span class="annot"><span class="annottext">perform :: forall a. StIO a -&gt; Action a
</span><a href="DataStructures.html#perform"><span class="hs-identifier hs-var hs-var">perform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StIO (Either String a) -&gt; Action a
forall a. StIO (Either String a) -&gt; Action a
</span><a href="DataStructures.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="annot"><span class="annottext">(StIO (Either String a) -&gt; Action a)
-&gt; (StateT Game IO a -&gt; StIO (Either String a))
-&gt; StateT Game IO a
-&gt; Action a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateT Game IO a
-&gt; (a -&gt; StIO (Either String a)) -&gt; StIO (Either String a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Either String a -&gt; StIO (Either String a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either String a -&gt; StIO (Either String a))
-&gt; (a -&gt; Either String a) -&gt; a -&gt; StIO (Either String a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either String a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- |Terminate an action flow with a custom message in 'String'.</span><span>
</span><span id="line-92"></span><span id="local-6989586621679060651"><span class="annot"><a href="DataStructures.html#terminate"><span class="hs-identifier hs-type">terminate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060651"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-93"></span><span id="terminate"><span class="annot"><span class="annottext">terminate :: forall a. String -&gt; Action a
</span><a href="DataStructures.html#terminate"><span class="hs-identifier hs-var hs-var">terminate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StIO (Either String a) -&gt; Action a
forall a. StIO (Either String a) -&gt; Action a
</span><a href="DataStructures.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="annot"><span class="annottext">(StIO (Either String a) -&gt; Action a)
-&gt; (String -&gt; StIO (Either String a)) -&gt; String -&gt; Action a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO (Either String a) -&gt; StIO (Either String a)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either String a) -&gt; StIO (Either String a))
-&gt; (String -&gt; IO (Either String a))
-&gt; String
-&gt; StIO (Either String a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either String a -&gt; IO (Either String a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either String a -&gt; IO (Either String a))
-&gt; (String -&gt; Either String a) -&gt; String -&gt; IO (Either String a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span></pre></body></html>