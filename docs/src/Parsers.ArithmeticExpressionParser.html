<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |Provides an 'expressionParser' parser for processing the arithmetic expressions.</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- The possible operations are: @+@, @-@, @*@, @/@ and @%@ (mod) and are defined for 'Int'.</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Moreover, the parser provides accessors to parameters (@player.\&lt;parameter\&gt;@ and @entity.\&lt;name\&gt;.\&lt;parameter\&gt;@)</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- and expressions: @invcount@ (count of the player inventory), @cmdcount@ (number of entered commands during the game)</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- and @rnd@ (random number).</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Parsers.ArithmeticExpressionParser</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="DataStructures.html"><span class="hs-identifier">DataStructures</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Attoparsec.Text</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Commands.html"><span class="hs-identifier">Commands</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Parsers.Utilities.html"><span class="hs-identifier">Parsers.Utilities</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-comment">-- * Grammar</span><span>
</span><span id="line-26"></span><span class="hs-comment">--</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- $grammar</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- The arithmetic expression grammar in this module is defined as follows:</span><span>
</span><span id="line-30"></span><span class="hs-comment">--</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- * expr -&gt; term expr'</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- * expr' -&gt; (@+@|@-@) term expr' | eps</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- * term -&gt; factor | term'</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- * term' -&gt; (@*@|@/@|@%@) factor term' | eps</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- * factor -&gt; @invcount@ | @cmdcount@ | @rnd@ | number | @player.\&lt;parameter\&gt;@ | @entity.\&lt;name\&gt;.parameter@ | ( expr )</span><span>
</span><span id="line-36"></span><span class="hs-comment">--</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- All operators are left-associative. Operators @*,/,%@ have higher priority than @+@ and @-@.</span><span>
</span><span id="line-38"></span><span class="hs-comment">--</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- * Parsing arithmetic expressions</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- |Match a @cmdcount@ expression.</span><span>
</span><span id="line-43"></span><span class="annot"><a href="Parsers.ArithmeticExpressionParser.html#commandCountParser"><span class="hs-identifier hs-type">commandCountParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span id="commandCountParser"><span class="annot"><span class="annottext">commandCountParser :: Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#commandCountParser"><span class="hs-identifier hs-var hs-var">commandCountParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><a href="Parsers.Utilities.html#stringWithSpaces"><span class="hs-identifier hs-var">stringWithSpaces</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cmdcount&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser (Action Int) -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Action Int -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Action Int
</span><a href="Commands.html#getCommandCount"><span class="hs-identifier hs-var">getCommandCount</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- |Match an @invcount@ expression.</span><span>
</span><span id="line-47"></span><span class="annot"><a href="Parsers.ArithmeticExpressionParser.html#inventoryCountParser"><span class="hs-identifier hs-type">inventoryCountParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span id="inventoryCountParser"><span class="annot"><span class="annottext">inventoryCountParser :: Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#inventoryCountParser"><span class="hs-identifier hs-var hs-var">inventoryCountParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><a href="Parsers.Utilities.html#stringWithSpaces"><span class="hs-identifier hs-var">stringWithSpaces</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;invcount&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser (Action Int) -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Action Int -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Action Int
</span><a href="Commands.html#getInventoryCount"><span class="hs-identifier hs-var">getInventoryCount</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- |Match a @rnd@ expression.</span><span>
</span><span id="line-51"></span><span class="annot"><a href="Parsers.ArithmeticExpressionParser.html#randomNumberParser"><span class="hs-identifier hs-type">randomNumberParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span id="randomNumberParser"><span class="annot"><span class="annottext">randomNumberParser :: Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#randomNumberParser"><span class="hs-identifier hs-var hs-var">randomNumberParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><a href="Parsers.Utilities.html#stringWithSpaces"><span class="hs-identifier hs-var">stringWithSpaces</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;rnd&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser (Action Int) -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Action Int -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Action Int
forall a (m :: * -&gt; *). (Random a, MonadIO m) =&gt; m a
</span><span class="hs-identifier hs-var">randomIO</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- |Match an expression of type @entity.&lt;entity name&gt;.&lt;parameter name&gt;@.</span><span>
</span><span id="line-55"></span><span class="annot"><a href="Parsers.ArithmeticExpressionParser.html#entityParameterAccessorParser"><span class="hs-identifier hs-type">entityParameterAccessorParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span id="entityParameterAccessorParser"><span class="annot"><span class="annottext">entityParameterAccessorParser :: Parser (Name, Name)
</span><a href="Parsers.ArithmeticExpressionParser.html#entityParameterAccessorParser"><span class="hs-identifier hs-var hs-var">entityParameterAccessorParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser (Name, Name) -&gt; Name -&gt; Parser (Name, Name)
forall a. Text -&gt; Parser a -&gt; Name -&gt; Parser a
</span><a href="Parsers.Utilities.html#baseCodeLineParser"><span class="hs-identifier hs-var">baseCodeLineParser</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;entity&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">Parser Char -&gt; Parser (Name, Name) -&gt; Parser (Name, Name)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Name -&gt; (Name, Name))
-&gt; Parser Text Name -&gt; Parser Text (Name -&gt; (Name, Name))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Name
</span><span class="hs-identifier hs-var">unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Name) -&gt; Parser Text -&gt; Parser Text Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text
</span><span class="hs-identifier hs-var">takeWhile1</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlphaNum</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text (Name -&gt; (Name, Name))
-&gt; Parser Text Name -&gt; Parser (Name, Name)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">Parser Char -&gt; Parser Text Name -&gt; Parser Text Name
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Name
</span><span class="hs-identifier hs-var">unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Name) -&gt; Parser Text -&gt; Parser Text Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text
</span><span class="hs-identifier hs-var">takeWhile1</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlphaNum</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser (Name, Name) -&gt; Name -&gt; Parser (Name, Name)
forall i a. Parser i a -&gt; Name -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;parameter&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;entity&quot;</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- |Match an expression of type @player.&lt;parameter name&gt;@.</span><span>
</span><span id="line-59"></span><span class="annot"><a href="Parsers.ArithmeticExpressionParser.html#playerParameterAccessorParser"><span class="hs-identifier hs-type">playerParameterAccessorParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-60"></span><span id="playerParameterAccessorParser"><span class="annot"><span class="annottext">playerParameterAccessorParser :: Parser Text Name
</span><a href="Parsers.ArithmeticExpressionParser.html#playerParameterAccessorParser"><span class="hs-identifier hs-var hs-var">playerParameterAccessorParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text Name -&gt; Name -&gt; Parser Text Name
forall a. Text -&gt; Parser a -&gt; Name -&gt; Parser a
</span><a href="Parsers.Utilities.html#baseCodeLineParser"><span class="hs-identifier hs-var">baseCodeLineParser</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;player&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">Parser Char -&gt; Parser Text Name -&gt; Parser Text Name
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Name
</span><span class="hs-identifier hs-var">unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Name) -&gt; Parser Text -&gt; Parser Text Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text
</span><span class="hs-identifier hs-var">takeWhile1</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlphaNum</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text Name -&gt; Parser Text () -&gt; Parser Text Name
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser Text ()
</span><a href="Parsers.Utilities.html#skipSpaces"><span class="hs-identifier hs-var">skipSpaces</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text Name -&gt; Name -&gt; Parser Text Name
forall i a. Parser i a -&gt; Name -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;parameter&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;player&quot;</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- |Match a number.</span><span>
</span><span id="line-63"></span><span class="annot"><a href="Parsers.ArithmeticExpressionParser.html#constantParser"><span class="hs-identifier hs-type">constantParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span id="constantParser"><span class="annot"><span class="annottext">constantParser :: Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#constantParser"><span class="hs-identifier hs-var hs-var">constantParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StIO Int -&gt; Action Int
forall a. StIO a -&gt; Action a
</span><a href="DataStructures.html#perform"><span class="hs-identifier hs-var">perform</span></a></span><span> </span><span class="annot"><span class="annottext">(StIO Int -&gt; Action Int) -&gt; (Int -&gt; StIO Int) -&gt; Int -&gt; Action Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO Int -&gt; StIO Int
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO Int -&gt; StIO Int) -&gt; (Int -&gt; IO Int) -&gt; Int -&gt; StIO Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO Int
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Action Int) -&gt; Parser Text Int -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Text Int -&gt; Parser Text Int
forall a. Num a =&gt; Parser a -&gt; Parser a
</span><span class="hs-identifier hs-var">signed</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Int
forall a. Integral a =&gt; Parser a
</span><span class="hs-identifier hs-var">decimal</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- |Match a parameter accessor expression.</span><span>
</span><span id="line-67"></span><span class="annot"><a href="Parsers.ArithmeticExpressionParser.html#identificatorParser"><span class="hs-identifier hs-type">identificatorParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span id="identificatorParser"><span class="annot"><span class="annottext">identificatorParser :: Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#identificatorParser"><span class="hs-identifier hs-var hs-var">identificatorParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Action Int
</span><a href="Commands.html#getPlayerParameter"><span class="hs-identifier hs-var">getPlayerParameter</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Action Int) -&gt; Parser Text Name -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Name
</span><a href="Parsers.ArithmeticExpressionParser.html#playerParameterAccessorParser"><span class="hs-identifier hs-var">playerParameterAccessorParser</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser (Action Int) -&gt; Parser (Action Int) -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Name -&gt; Action Int) -&gt; (Name, Name) -&gt; Action Int
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Action Int
</span><a href="Commands.html#getEntityParameter"><span class="hs-identifier hs-var">getEntityParameter</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Name, Name) -&gt; Action Int)
-&gt; Parser (Name, Name) -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser (Name, Name)
</span><a href="Parsers.ArithmeticExpressionParser.html#entityParameterAccessorParser"><span class="hs-identifier hs-var">entityParameterAccessorParser</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- |Match multiplication or division operator.</span><span>
</span><span id="line-71"></span><span class="annot"><a href="Parsers.ArithmeticExpressionParser.html#mulOpParser"><span class="hs-identifier hs-type">mulOpParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span id="mulOpParser"><span class="annot"><span class="annottext">mulOpParser :: Parser (Action Int -&gt; Action Int -&gt; Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#mulOpParser"><span class="hs-identifier hs-var hs-var">mulOpParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><a href="Parsers.Utilities.html#charWithSpaces"><span class="hs-identifier hs-var">charWithSpaces</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span> </span><span class="annot"><span class="annottext">Parser Char
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
forall a b.
(a -&gt; a -&gt; b) -&gt; Parser (Action a -&gt; Action a -&gt; Action b)
</span><a href="Parsers.Utilities.html#liftPAction"><span class="hs-identifier hs-var">liftPAction</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser (Action Int -&gt; Action Int -&gt; Action Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><a href="Parsers.Utilities.html#charWithSpaces"><span class="hs-identifier hs-var">charWithSpaces</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="annottext">Parser Char
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
forall a b.
(a -&gt; a -&gt; b) -&gt; Parser (Action a -&gt; Action a -&gt; Action b)
</span><a href="Parsers.Utilities.html#liftPAction"><span class="hs-identifier hs-var">liftPAction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; Int -&gt; Int -&gt; Int
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser (Action Int -&gt; Action Int -&gt; Action Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><a href="Parsers.Utilities.html#charWithSpaces"><span class="hs-identifier hs-var">charWithSpaces</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'%'</span></span><span> </span><span class="annot"><span class="annottext">Parser Char
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
forall a b.
(a -&gt; a -&gt; b) -&gt; Parser (Action a -&gt; Action a -&gt; Action b)
</span><a href="Parsers.Utilities.html#liftPAction"><span class="hs-identifier hs-var">liftPAction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; Int -&gt; Int -&gt; Int
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- |Match addition or subtraction operator.</span><span>
</span><span id="line-75"></span><span class="annot"><a href="Parsers.ArithmeticExpressionParser.html#addOpParser"><span class="hs-identifier hs-type">addOpParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span id="addOpParser"><span class="annot"><span class="annottext">addOpParser :: Parser (Action Int -&gt; Action Int -&gt; Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#addOpParser"><span class="hs-identifier hs-var hs-var">addOpParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><a href="Parsers.Utilities.html#charWithSpaces"><span class="hs-identifier hs-var">charWithSpaces</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'+'</span></span><span> </span><span class="annot"><span class="annottext">Parser Char
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
forall a b.
(a -&gt; a -&gt; b) -&gt; Parser (Action a -&gt; Action a -&gt; Action b)
</span><a href="Parsers.Utilities.html#liftPAction"><span class="hs-identifier hs-var">liftPAction</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser (Action Int -&gt; Action Int -&gt; Action Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><a href="Parsers.Utilities.html#charWithSpaces"><span class="hs-identifier hs-var">charWithSpaces</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="annottext">Parser Char
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int)
-&gt; Parser (Action Int -&gt; Action Int -&gt; Action Int)
forall a b.
(a -&gt; a -&gt; b) -&gt; Parser (Action a -&gt; Action a -&gt; Action b)
</span><a href="Parsers.Utilities.html#liftPAction"><span class="hs-identifier hs-var">liftPAction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; Int -&gt; Int -&gt; Int
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- |Match a single term of a sum.</span><span>
</span><span id="line-79"></span><span class="annot"><a href="Parsers.ArithmeticExpressionParser.html#termParser"><span class="hs-identifier hs-type">termParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span id="termParser"><span class="annot"><span class="annottext">termParser :: Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#termParser"><span class="hs-identifier hs-var hs-var">termParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#factorParser"><span class="hs-identifier hs-var">factorParser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser (Action Int)
-&gt; Parser Text (Action Int -&gt; Action Int) -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;**&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text (Action Int -&gt; Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#termParser%27"><span class="hs-identifier hs-var">termParser'</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- |Match a @term'@ non-terminal from a grammar, preserving left-associativity of the operators.</span><span>
</span><span id="line-83"></span><span class="annot"><a href="Parsers.ArithmeticExpressionParser.html#termParser%27"><span class="hs-identifier hs-type">termParser'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span id="termParser%27"><span class="annot"><span class="annottext">termParser' :: Parser Text (Action Int -&gt; Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#termParser%27"><span class="hs-identifier hs-var hs-var">termParser'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Action Int -&gt; Action Int)
 -&gt; (Action Int -&gt; Action Int) -&gt; Action Int -&gt; Action Int)
-&gt; (Action Int -&gt; Action Int)
-&gt; (Action Int -&gt; Action Int)
-&gt; Action Int
-&gt; Action Int
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Action Int -&gt; Action Int)
-&gt; (Action Int -&gt; Action Int) -&gt; Action Int -&gt; Action Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">((Action Int -&gt; Action Int)
 -&gt; (Action Int -&gt; Action Int) -&gt; Action Int -&gt; Action Int)
-&gt; Parser Text (Action Int -&gt; Action Int)
-&gt; Parser
     Text ((Action Int -&gt; Action Int) -&gt; Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser (Action Int -&gt; Action Int -&gt; Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#mulOpParser"><span class="hs-identifier hs-var">mulOpParser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser (Action Int -&gt; Action Int -&gt; Action Int)
-&gt; Parser (Action Int) -&gt; Parser Text (Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#factorParser"><span class="hs-identifier hs-var">factorParser</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser
  Text ((Action Int -&gt; Action Int) -&gt; Action Int -&gt; Action Int)
-&gt; Parser Text (Action Int -&gt; Action Int)
-&gt; Parser Text (Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text (Action Int -&gt; Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#termParser%27"><span class="hs-identifier hs-var">termParser'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text (Action Int -&gt; Action Int)
-&gt; Parser Text (Action Int -&gt; Action Int)
-&gt; Parser Text (Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Action Int -&gt; Action Int)
-&gt; Parser Text (Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Action Int -&gt; Action Int
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- |Match an arithmetic expression and return its symbolic representation in a parser.</span><span>
</span><span id="line-87"></span><span class="annot"><a href="Parsers.ArithmeticExpressionParser.html#expressionParser"><span class="hs-identifier hs-type">expressionParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span id="expressionParser"><span class="annot"><span class="annottext">expressionParser :: Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#expressionParser"><span class="hs-identifier hs-var hs-var">expressionParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#termParser"><span class="hs-identifier hs-var">termParser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser (Action Int)
-&gt; Parser Text (Action Int -&gt; Action Int) -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;**&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text (Action Int -&gt; Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#expressionParser%27"><span class="hs-identifier hs-var">expressionParser'</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- |Match a @expr'@ non-terminal from a grammar, preserving left-associativity of the operators.</span><span>
</span><span id="line-91"></span><span class="annot"><a href="Parsers.ArithmeticExpressionParser.html#expressionParser%27"><span class="hs-identifier hs-type">expressionParser'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span id="expressionParser%27"><span class="annot"><span class="annottext">expressionParser' :: Parser Text (Action Int -&gt; Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#expressionParser%27"><span class="hs-identifier hs-var hs-var">expressionParser'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Action Int -&gt; Action Int)
 -&gt; (Action Int -&gt; Action Int) -&gt; Action Int -&gt; Action Int)
-&gt; (Action Int -&gt; Action Int)
-&gt; (Action Int -&gt; Action Int)
-&gt; Action Int
-&gt; Action Int
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Action Int -&gt; Action Int)
-&gt; (Action Int -&gt; Action Int) -&gt; Action Int -&gt; Action Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">((Action Int -&gt; Action Int)
 -&gt; (Action Int -&gt; Action Int) -&gt; Action Int -&gt; Action Int)
-&gt; Parser Text (Action Int -&gt; Action Int)
-&gt; Parser
     Text ((Action Int -&gt; Action Int) -&gt; Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser (Action Int -&gt; Action Int -&gt; Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#addOpParser"><span class="hs-identifier hs-var">addOpParser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser (Action Int -&gt; Action Int -&gt; Action Int)
-&gt; Parser (Action Int) -&gt; Parser Text (Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#termParser"><span class="hs-identifier hs-var">termParser</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser
  Text ((Action Int -&gt; Action Int) -&gt; Action Int -&gt; Action Int)
-&gt; Parser Text (Action Int -&gt; Action Int)
-&gt; Parser Text (Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text (Action Int -&gt; Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#expressionParser%27"><span class="hs-identifier hs-var">expressionParser'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text (Action Int -&gt; Action Int)
-&gt; Parser Text (Action Int -&gt; Action Int)
-&gt; Parser Text (Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Action Int -&gt; Action Int)
-&gt; Parser Text (Action Int -&gt; Action Int)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Action Int -&gt; Action Int
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- |Match a single factor of a term.</span><span>
</span><span id="line-95"></span><span class="annot"><a href="Parsers.ArithmeticExpressionParser.html#factorParser"><span class="hs-identifier hs-type">factorParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span id="factorParser"><span class="annot"><span class="annottext">factorParser :: Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#factorParser"><span class="hs-identifier hs-var hs-var">factorParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><span class="annottext">Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#inventoryCountParser"><span class="hs-identifier hs-var">inventoryCountParser</span></a></span><span> </span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">Parser (Action Int) -&gt; Parser (Action Int) -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#commandCountParser"><span class="hs-identifier hs-var">commandCountParser</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><span class="annottext">Parser (Action Int) -&gt; Parser (Action Int) -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#randomNumberParser"><span class="hs-identifier hs-var">randomNumberParser</span></a></span><span> </span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="annottext">Parser (Action Int) -&gt; Parser (Action Int) -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#constantParser"><span class="hs-identifier hs-var">constantParser</span></a></span><span> </span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">Parser (Action Int) -&gt; Parser (Action Int) -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#identificatorParser"><span class="hs-identifier hs-var">identificatorParser</span></a></span><span> </span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="annottext">Parser (Action Int) -&gt; Parser (Action Int) -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><a href="Parsers.Utilities.html#charWithSpaces"><span class="hs-identifier hs-var">charWithSpaces</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span> </span><span class="annot"><span class="annottext">Parser Char -&gt; Parser (Action Int) -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser (Action Int)
</span><a href="Parsers.ArithmeticExpressionParser.html#expressionParser"><span class="hs-identifier hs-var">expressionParser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser (Action Int) -&gt; Parser Char -&gt; Parser (Action Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><a href="Parsers.Utilities.html#charWithSpaces"><span class="hs-identifier hs-var">charWithSpaces</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">')'</span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span></pre></body></html>