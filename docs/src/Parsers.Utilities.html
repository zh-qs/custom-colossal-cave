<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Parsers.Utilities</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="DataStructures.html"><span class="hs-identifier">DataStructures</span></a></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Attoparsec.Text</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Commands.html"><span class="hs-identifier">Commands</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-comment">-- |Returns @True@ if 'Char' is a new line character (@\n@ or @\r@).</span><span>
</span><span id="line-19"></span><span class="annot"><a href="Parsers.Utilities.html#isNewline"><span class="hs-identifier hs-type">isNewline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-20"></span><span id="isNewline"><span class="annot"><span class="annottext">isNewline :: Char -&gt; Bool
</span><a href="Parsers.Utilities.html#isNewline"><span class="hs-identifier hs-var hs-var">isNewline</span></a></span></span><span> </span><span id="local-6989586621679061960"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679061960"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679061960"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679061960"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\r'</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- |Skip consecutive whitespace characters.</span><span>
</span><span id="line-23"></span><span class="annot"><a href="Parsers.Utilities.html#skipSpaces"><span class="hs-identifier hs-type">skipSpaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span id="skipSpaces"><span class="annot"><span class="annottext">skipSpaces :: Parser ()
</span><a href="Parsers.Utilities.html#skipSpaces"><span class="hs-identifier hs-var hs-var">skipSpaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser ()
</span><span class="hs-identifier hs-var">skipWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-- |Match a char with whitespace characters around.</span><span>
</span><span id="line-27"></span><span class="annot"><a href="Parsers.Utilities.html#charWithSpaces"><span class="hs-identifier hs-type">charWithSpaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-28"></span><span id="charWithSpaces"><span class="annot"><span class="annottext">charWithSpaces :: Char -&gt; Parser Char
</span><a href="Parsers.Utilities.html#charWithSpaces"><span class="hs-identifier hs-var hs-var">charWithSpaces</span></a></span></span><span> </span><span id="local-6989586621679061954"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679061954"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Parsers.Utilities.html#skipSpaces"><span class="hs-identifier hs-var">skipSpaces</span></a></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Char -&gt; Parser Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679061954"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Char -&gt; Parser () -&gt; Parser Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Parsers.Utilities.html#skipSpaces"><span class="hs-identifier hs-var">skipSpaces</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- |Match a string with whitespace characters around.</span><span>
</span><span id="line-31"></span><span class="annot"><a href="Parsers.Utilities.html#stringWithSpaces"><span class="hs-identifier hs-type">stringWithSpaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-32"></span><span id="stringWithSpaces"><span class="annot"><span class="annottext">stringWithSpaces :: Text -&gt; Parser Text
</span><a href="Parsers.Utilities.html#stringWithSpaces"><span class="hs-identifier hs-var hs-var">stringWithSpaces</span></a></span></span><span> </span><span id="local-6989586621679061950"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679061950"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Parsers.Utilities.html#skipSpaces"><span class="hs-identifier hs-var">skipSpaces</span></a></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679061950"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser () -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Parsers.Utilities.html#skipSpaces"><span class="hs-identifier hs-var">skipSpaces</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-comment">-- |Match zero or more newline characters.</span><span>
</span><span id="line-35"></span><span class="annot"><a href="Parsers.Utilities.html#newLines"><span class="hs-identifier hs-type">newLines</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span id="newLines"><span class="annot"><span class="annottext">newLines :: Parser ()
</span><a href="Parsers.Utilities.html#newLines"><span class="hs-identifier hs-var hs-var">newLines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser ()
</span><span class="hs-identifier hs-var">skipWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Parsers.Utilities.html#isNewline"><span class="hs-identifier hs-var">isNewline</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; [Char] -&gt; Parser ()
forall i a. Parser i a -&gt; [Char] -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;no newline&quot;</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- |Match one or more newline characters.</span><span>
</span><span id="line-39"></span><span class="annot"><a href="Parsers.Utilities.html#newLines1"><span class="hs-identifier hs-type">newLines1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span id="newLines1"><span class="annot"><span class="annottext">newLines1 :: Parser ()
</span><a href="Parsers.Utilities.html#newLines1"><span class="hs-identifier hs-var hs-var">newLines1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser ()
</span><span class="hs-identifier hs-var">skip</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Parsers.Utilities.html#isNewline"><span class="hs-identifier hs-var">isNewline</span></a></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser ()
</span><span class="hs-identifier hs-var">skipWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Parsers.Utilities.html#isNewline"><span class="hs-identifier hs-var">isNewline</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; [Char] -&gt; Parser ()
forall i a. Parser i a -&gt; [Char] -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;no newline&quot;</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- |Match a tab character (@\t@) or two spaces.</span><span>
</span><span id="line-43"></span><span class="annot"><a href="Parsers.Utilities.html#tabOrTwoSpaces"><span class="hs-identifier hs-type">tabOrTwoSpaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span id="tabOrTwoSpaces"><span class="annot"><span class="annottext">tabOrTwoSpaces :: Parser ()
</span><a href="Parsers.Utilities.html#tabOrTwoSpaces"><span class="hs-identifier hs-var hs-var">tabOrTwoSpaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Char -&gt; Parser ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(Parser Char -&gt; Parser ()) -&gt; Parser Char -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\t'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Text -&gt; Parser ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; Parser ()) -&gt; Parser Text -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;  &quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; [Char] -&gt; Parser ()
forall i a. Parser i a -&gt; [Char] -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unproper indenting&quot;</span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- |Match a number of tabs (or two spaces) specified by 'Int'.</span><span>
</span><span id="line-47"></span><span class="annot"><a href="Parsers.Utilities.html#tabs"><span class="hs-identifier hs-type">tabs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span id="tabs"><span class="annot"><span class="annottext">tabs :: Int -&gt; Parser ()
</span><a href="Parsers.Utilities.html#tabs"><span class="hs-identifier hs-var hs-var">tabs</span></a></span></span><span> </span><span id="local-6989586621679061940"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061940"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Parser () -&gt; Parser () -&gt; Parser ())
-&gt; Parser () -&gt; [Parser ()] -&gt; Parser ()
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">Prelude.foldr</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">(*&gt;)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Parser ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Parser ()] -&gt; [Parser ()]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">Prelude.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061940"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([Parser ()] -&gt; [Parser ()]) -&gt; [Parser ()] -&gt; [Parser ()]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; [Parser ()]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">(Parser () -&gt; [Parser ()]) -&gt; Parser () -&gt; [Parser ()]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Parsers.Utilities.html#tabOrTwoSpaces"><span class="hs-identifier hs-var">tabOrTwoSpaces</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- |Match a list of items stated by 'Text'. 'Parser a' matches single item, 'Int' is an indentation level and 'String' is a message in case of parsing failure.</span><span>
</span><span id="line-51"></span><span id="local-6989586621679062071"><span class="annot"><a href="Parsers.Utilities.html#listParser"><span class="hs-identifier hs-type">listParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="#local-6989586621679062071"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679062071"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-52"></span><span id="listParser"><span class="annot"><span class="annottext">listParser :: forall a. Text -&gt; Parser a -&gt; Int -&gt; [Char] -&gt; Parser [a]
</span><a href="Parsers.Utilities.html#listParser"><span class="hs-identifier hs-var hs-var">listParser</span></a></span></span><span> </span><span id="local-6989586621679061928"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679061928"><span class="hs-identifier hs-var">keyword</span></a></span></span><span> </span><span id="local-6989586621679061927"><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621679061927"><span class="hs-identifier hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621679061926"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061926"><span class="hs-identifier hs-var">indentationLevel</span></a></span></span><span> </span><span id="local-6989586621679061925"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679061925"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679061928"><span class="hs-identifier hs-var">keyword</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Char -&gt; Parser Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Char -&gt; [Char] -&gt; Parser Char
forall i a. Parser i a -&gt; [Char] -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;keyword&quot;</span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="annottext">Parser Char -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Parsers.Utilities.html#newLines"><span class="hs-identifier hs-var">newLines</span></a></span><span>  </span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text [a] -&gt; Parser Text [a]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser a -&gt; Parser Text [a]
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">many'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Parser ()
</span><a href="Parsers.Utilities.html#tabs"><span class="hs-identifier hs-var">tabs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061926"><span class="hs-identifier hs-var">indentationLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;- &quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621679061927"><span class="hs-identifier hs-var">parser</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="annottext">Parser Text [a] -&gt; [Char] -&gt; Parser Text [a]
forall i a. Parser i a -&gt; [Char] -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679061925"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- |Match a list of items stated by 'Text'. Lifted version of 'listParser'.</span><span>
</span><span id="line-59"></span><span id="local-6989586621679062067"><span class="annot"><a href="Parsers.Utilities.html#listParserSt"><span class="hs-identifier hs-type">listParserSt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#StParser"><span class="hs-identifier hs-type">StParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062067"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#StParser"><span class="hs-identifier hs-type">StParser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679062067"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-60"></span><span id="listParserSt"><span class="annot"><span class="annottext">listParserSt :: forall a. Text -&gt; StParser a -&gt; Int -&gt; [Char] -&gt; StParser [a]
</span><a href="Parsers.Utilities.html#listParserSt"><span class="hs-identifier hs-var hs-var">listParserSt</span></a></span></span><span> </span><span id="local-6989586621679061904"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679061904"><span class="hs-identifier hs-var">keyword</span></a></span></span><span> </span><span id="local-6989586621679061903"><span class="annot"><span class="annottext">StParser a
</span><a href="#local-6989586621679061903"><span class="hs-identifier hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621679061902"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061902"><span class="hs-identifier hs-var">indentationLevel</span></a></span></span><span> </span><span id="local-6989586621679061901"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679061901"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Char
-&gt; StateT (Map [Char] Interactable, Action ()) (Parser Text) Char
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679061904"><span class="hs-identifier hs-var">keyword</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Char -&gt; Parser Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Char -&gt; [Char] -&gt; Parser Char
forall i a. Parser i a -&gt; [Char] -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;keyword&quot;</span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="annottext">StateT (Map [Char] Interactable, Action ()) (Parser Text) Char
-&gt; StateT (Map [Char] Interactable, Action ()) (Parser Text) ()
-&gt; StateT (Map [Char] Interactable, Action ()) (Parser Text) ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
-&gt; StateT (Map [Char] Interactable, Action ()) (Parser Text) ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Parsers.Utilities.html#newLines"><span class="hs-identifier hs-var">newLines</span></a></span><span>  </span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="annottext">StateT (Map [Char] Interactable, Action ()) (Parser Text) ()
-&gt; StateT (Map [Char] Interactable, Action ()) (Parser Text) [a]
-&gt; StateT (Map [Char] Interactable, Action ()) (Parser Text) [a]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StParser a
-&gt; StateT (Map [Char] Interactable, Action ()) (Parser Text) [a]
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">many'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser ()
-&gt; StateT (Map [Char] Interactable, Action ()) (Parser Text) ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Parser ()
</span><a href="Parsers.Utilities.html#tabs"><span class="hs-identifier hs-var">tabs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061902"><span class="hs-identifier hs-var">indentationLevel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT (Map [Char] Interactable, Action ()) (Parser Text) ()
-&gt; StateT (Map [Char] Interactable, Action ()) (Parser Text) Text
-&gt; StateT (Map [Char] Interactable, Action ()) (Parser Text) Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
-&gt; StateT (Map [Char] Interactable, Action ()) (Parser Text) Text
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;- &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT (Map [Char] Interactable, Action ()) (Parser Text) Text
-&gt; StParser a -&gt; StParser a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">StParser a
</span><a href="#local-6989586621679061903"><span class="hs-identifier hs-var">parser</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="annottext">StateT (Map [Char] Interactable, Action ()) (Parser Text) [a]
-&gt; [Char]
-&gt; StateT (Map [Char] Interactable, Action ()) (Parser Text) [a]
forall a. StParser a -&gt; [Char] -&gt; StParser a
</span><a href="DataStructures.html#%3C%3F%3F%3E"><span class="hs-operator hs-var">&lt;??&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679061901"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- |Match a code line with keyword 'Text', instruction content parser 'Parser a'. 'String' is a message in case of parsing failure.</span><span>
</span><span id="line-67"></span><span id="local-6989586621679062050"><span class="annot"><a href="Parsers.Utilities.html#baseCodeLineParser"><span class="hs-identifier hs-type">baseCodeLineParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="#local-6989586621679062050"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="#local-6989586621679062050"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-68"></span><span id="baseCodeLineParser"><span class="annot"><span class="annottext">baseCodeLineParser :: forall a. Text -&gt; Parser a -&gt; [Char] -&gt; Parser a
</span><a href="Parsers.Utilities.html#baseCodeLineParser"><span class="hs-identifier hs-var hs-var">baseCodeLineParser</span></a></span></span><span> </span><span id="local-6989586621679061895"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679061895"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621679061894"><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621679061894"><span class="hs-identifier hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621679061893"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679061893"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679061895"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; [Char] -&gt; Parser Text
forall i a. Parser i a -&gt; [Char] -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;keyword&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621679061894"><span class="hs-identifier hs-var">parser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser a -&gt; Parser () -&gt; Parser a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Parsers.Utilities.html#newLines"><span class="hs-identifier hs-var">newLines</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser a -&gt; [Char] -&gt; Parser a
forall i a. Parser i a -&gt; [Char] -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679061893"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- |Match a multiline string, where 'Text' is a keyword,'Int' is an indentation level and 'String' is a message in case of parsing failure.</span><span>
</span><span id="line-71"></span><span class="annot"><a href="Parsers.Utilities.html#multilineContentParser"><span class="hs-identifier hs-type">multilineContentParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-72"></span><span id="multilineContentParser"><span class="annot"><span class="annottext">multilineContentParser :: Text -&gt; Int -&gt; [Char] -&gt; Parser [Char]
</span><a href="Parsers.Utilities.html#multilineContentParser"><span class="hs-identifier hs-var hs-var">multilineContentParser</span></a></span></span><span> </span><span id="local-6989586621679061891"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679061891"><span class="hs-identifier hs-var">keyword</span></a></span></span><span> </span><span id="local-6989586621679061890"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061890"><span class="hs-identifier hs-var">indentationLevel</span></a></span></span><span> </span><span id="local-6989586621679061889"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679061889"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679061891"><span class="hs-identifier hs-var">keyword</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Char -&gt; Parser Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">Parser Char -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Parsers.Utilities.html#newLines"><span class="hs-identifier hs-var">newLines</span></a></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser [Char] -&gt; Parser [Char]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Char] -&gt; [Char] -&gt; [Char]) -&gt; [Char] -&gt; [[Char]] -&gt; [Char]
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">Data.List.foldl'</span></span><span> </span><span class="annot"><span class="annottext">(([Char] -&gt; [Char] -&gt; [Char]) -&gt; [Char] -&gt; [[Char]] -&gt; [Char])
-&gt; Parser Text ([Char] -&gt; [Char] -&gt; [Char])
-&gt; Parser Text ([Char] -&gt; [[Char]] -&gt; [Char])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char] -&gt; [Char])
-&gt; Parser Text ([Char] -&gt; [Char] -&gt; [Char])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="annot"><span class="annottext">Parser Text ([Char] -&gt; [[Char]] -&gt; [Char])
-&gt; Parser [Char] -&gt; Parser Text ([[Char]] -&gt; [Char])
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser [Char]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text ([[Char]] -&gt; [Char])
-&gt; Parser Text [[Char]] -&gt; Parser [Char]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser [Char] -&gt; Parser Text [[Char]]
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">many'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Parser ()
</span><a href="Parsers.Utilities.html#tabs"><span class="hs-identifier hs-var">tabs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061890"><span class="hs-identifier hs-var">indentationLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser [Char] -&gt; Parser [Char]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; (Text -&gt; [Char]) -&gt; Text -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">unpack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [Char]) -&gt; Parser Text -&gt; Parser [Char]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text
</span><span class="hs-identifier hs-var">Data.Attoparsec.Text.takeTill</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Parsers.Utilities.html#isNewline"><span class="hs-identifier hs-var">isNewline</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser [Char] -&gt; Parser () -&gt; Parser [Char]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Parsers.Utilities.html#newLines"><span class="hs-identifier hs-var">newLines</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser [Char] -&gt; [Char] -&gt; Parser [Char]
forall i a. Parser i a -&gt; [Char] -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679061889"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- |Match a multiline string, 'Int' is an indentation level and 'String' is a message in case of parsing failure.</span><span>
</span><span id="line-75"></span><span class="annot"><a href="Parsers.Utilities.html#multilineContentParser%27"><span class="hs-identifier hs-type">multilineContentParser'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-76"></span><span id="multilineContentParser%27"><span class="annot"><span class="annottext">multilineContentParser' :: Int -&gt; [Char] -&gt; Parser [Char]
</span><a href="Parsers.Utilities.html#multilineContentParser%27"><span class="hs-identifier hs-var hs-var">multilineContentParser'</span></a></span></span><span> </span><span id="local-6989586621679061881"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061881"><span class="hs-identifier hs-var">indentationLevel</span></a></span></span><span> </span><span id="local-6989586621679061880"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679061880"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Char] -&gt; [Char] -&gt; [Char]) -&gt; [Char] -&gt; [[Char]] -&gt; [Char]
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">Data.List.foldl'</span></span><span> </span><span class="annot"><span class="annottext">(([Char] -&gt; [Char] -&gt; [Char]) -&gt; [Char] -&gt; [[Char]] -&gt; [Char])
-&gt; Parser Text ([Char] -&gt; [Char] -&gt; [Char])
-&gt; Parser Text ([Char] -&gt; [[Char]] -&gt; [Char])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char] -&gt; [Char])
-&gt; Parser Text ([Char] -&gt; [Char] -&gt; [Char])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="annot"><span class="annottext">Parser Text ([Char] -&gt; [[Char]] -&gt; [Char])
-&gt; Parser [Char] -&gt; Parser Text ([[Char]] -&gt; [Char])
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser [Char]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text ([[Char]] -&gt; [Char])
-&gt; Parser Text [[Char]] -&gt; Parser [Char]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser [Char] -&gt; Parser Text [[Char]]
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">many'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Parser ()
</span><a href="Parsers.Utilities.html#tabs"><span class="hs-identifier hs-var">tabs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061881"><span class="hs-identifier hs-var">indentationLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser [Char] -&gt; Parser [Char]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; (Text -&gt; [Char]) -&gt; Text -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">unpack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [Char]) -&gt; Parser Text -&gt; Parser [Char]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text
</span><span class="hs-identifier hs-var">Data.Attoparsec.Text.takeTill</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Parsers.Utilities.html#isNewline"><span class="hs-identifier hs-var">isNewline</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser [Char] -&gt; Parser () -&gt; Parser [Char]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Parsers.Utilities.html#newLines"><span class="hs-identifier hs-var">newLines</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser [Char] -&gt; [Char] -&gt; Parser [Char]
forall i a. Parser i a -&gt; [Char] -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679061880"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- |Lifts a two-argument function to 'Action' and wraps it into a 'Parser'.</span><span>
</span><span id="line-79"></span><span id="local-6989586621679062035"><span id="local-6989586621679062036"><span class="annot"><a href="Parsers.Utilities.html#liftPAction"><span class="hs-identifier hs-type">liftPAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062036"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062036"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062035"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062036"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062036"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062035"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-80"></span><span id="liftPAction"><span class="annot"><span class="annottext">liftPAction :: forall a b.
(a -&gt; a -&gt; b) -&gt; Parser (Action a -&gt; Action a -&gt; Action b)
</span><a href="Parsers.Utilities.html#liftPAction"><span class="hs-identifier hs-var hs-var">liftPAction</span></a></span></span><span> </span><span id="local-6989586621679061873"><span class="annot"><span class="annottext">a -&gt; a -&gt; b
</span><a href="#local-6989586621679061873"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Action a -&gt; Action a -&gt; Action b)
-&gt; Parser Text (Action a -&gt; Action a -&gt; Action b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679061872"><span class="annot"><span class="annottext">Action a
</span><a href="#local-6989586621679061872"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621679061871"><span class="annot"><span class="annottext">Action a
</span><a href="#local-6989586621679061871"><span class="hs-identifier hs-var">ay</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; b
</span><a href="#local-6989586621679061873"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; b) -&gt; Action a -&gt; Action (a -&gt; b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Action a
</span><a href="#local-6989586621679061872"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">Action (a -&gt; b) -&gt; Action a -&gt; Action b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Action a
</span><a href="#local-6989586621679061871"><span class="hs-identifier hs-var">ay</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- |Lifts a two-argument function to 'StIO' and wraps it into a 'Parser'.</span><span>
</span><span id="line-83"></span><span id="local-6989586621679062031"><span id="local-6989586621679062032"><span class="annot"><a href="Parsers.Utilities.html#liftPStIO"><span class="hs-identifier hs-type">liftPStIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062032"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062032"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062031"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#StIO"><span class="hs-identifier hs-type">StIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062032"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#StIO"><span class="hs-identifier hs-type">StIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062032"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#StIO"><span class="hs-identifier hs-type">StIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062031"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-84"></span><span id="liftPStIO"><span class="annot"><span class="annottext">liftPStIO :: forall a b. (a -&gt; a -&gt; b) -&gt; Parser (StIO a -&gt; StIO a -&gt; StIO b)
</span><a href="Parsers.Utilities.html#liftPStIO"><span class="hs-identifier hs-var hs-var">liftPStIO</span></a></span></span><span> </span><span id="local-6989586621679061861"><span class="annot"><span class="annottext">a -&gt; a -&gt; b
</span><a href="#local-6989586621679061861"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StateT Game IO a -&gt; StateT Game IO a -&gt; StateT Game IO b)
-&gt; Parser
     Text (StateT Game IO a -&gt; StateT Game IO a -&gt; StateT Game IO b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679061860"><span class="annot"><span class="annottext">StateT Game IO a
</span><a href="#local-6989586621679061860"><span class="hs-identifier hs-var">stx</span></a></span></span><span> </span><span id="local-6989586621679061859"><span class="annot"><span class="annottext">StateT Game IO a
</span><a href="#local-6989586621679061859"><span class="hs-identifier hs-var">sty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; b
</span><a href="#local-6989586621679061861"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; b) -&gt; StateT Game IO a -&gt; StateT Game IO (a -&gt; b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateT Game IO a
</span><a href="#local-6989586621679061860"><span class="hs-identifier hs-var">stx</span></a></span><span> </span><span class="annot"><span class="annottext">StateT Game IO (a -&gt; b) -&gt; StateT Game IO a -&gt; StateT Game IO b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateT Game IO a
</span><a href="#local-6989586621679061859"><span class="hs-identifier hs-var">sty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- |Version of attoparsec's function 'eitherResult', which in case of failure prints additionally a piece of unconsumed GAML code.</span><span>
</span><span id="line-87"></span><span id="local-6989586621679062024"><span class="annot"><a href="Parsers.Utilities.html#eitherResult%27"><span class="hs-identifier hs-type">eitherResult'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Result</span></span><span> </span><span class="annot"><a href="#local-6989586621679062024"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679062024"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-88"></span><span id="eitherResult%27"><span class="annot"><span class="annottext">eitherResult' :: forall r. Result r -&gt; Either [Char] r
</span><a href="Parsers.Utilities.html#eitherResult%27"><span class="hs-identifier hs-var hs-var">eitherResult'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Done</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061851"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679061851"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; Either [Char] r
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679061851"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Parsers.Utilities.html#eitherResult%27"><span class="hs-identifier hs-var">eitherResult'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fail</span></span><span> </span><span id="local-6989586621679061849"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679061849"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679061848"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679061848"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] r
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679061848"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; near: \n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char] -&gt; [Char]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">Data.List.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679061849"><span class="hs-identifier hs-var">txt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="annot"><a href="Parsers.Utilities.html#eitherResult%27"><span class="hs-identifier hs-var">eitherResult'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fail</span></span><span> </span><span id="local-6989586621679061847"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679061847"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span id="local-6989586621679061846"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679061846"><span class="hs-identifier hs-var">ctxs</span></a></span></span><span> </span><span id="local-6989586621679061845"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679061845"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] r
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">Data.List.intercalate</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679061846"><span class="hs-identifier hs-var">ctxs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679061845"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; near: \n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char] -&gt; [Char]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">Data.List.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679061847"><span class="hs-identifier hs-var">txt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="annot"><a href="Parsers.Utilities.html#eitherResult%27"><span class="hs-identifier hs-var">eitherResult'</span></a></span><span> </span><span class="annot"><span class="annottext">IResult Text r
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] r
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Result: incomplete input&quot;</span></span><span>
</span><span id="line-92"></span></pre></body></html>