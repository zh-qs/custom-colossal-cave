<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GameIO</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="DataStructures.html"><span class="hs-identifier">DataStructures</span></a></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Environment</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Error</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Merge.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">data</span><span> </span><span id="InteractableState"><span class="annot"><a href="GameIO.html#InteractableState"><span class="hs-identifier hs-var">InteractableState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ItemState"><span class="annot"><a href="GameIO.html#ItemState"><span class="hs-identifier hs-var">ItemState</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="EntityState"><span class="annot"><a href="GameIO.html#EntityState"><span class="hs-identifier hs-var">EntityState</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="entityStateParameters"><span class="annot"><span class="annottext">InteractableState -&gt; Map Name Int
</span><a href="GameIO.html#entityStateParameters"><span class="hs-identifier hs-var hs-var">entityStateParameters</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060943"><span id="local-6989586621679060945"><span id="local-6989586621679060953"><span class="annot"><span class="annottext">Int -&gt; InteractableState -&gt; ShowS
[InteractableState] -&gt; ShowS
InteractableState -&gt; Name
(Int -&gt; InteractableState -&gt; ShowS)
-&gt; (InteractableState -&gt; Name)
-&gt; ([InteractableState] -&gt; ShowS)
-&gt; Show InteractableState
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; Name) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [InteractableState] -&gt; ShowS
$cshowList :: [InteractableState] -&gt; ShowS
show :: InteractableState -&gt; Name
$cshow :: InteractableState -&gt; Name
showsPrec :: Int -&gt; InteractableState -&gt; ShowS
$cshowsPrec :: Int -&gt; InteractableState -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060917"><span id="local-6989586621679060931"><span id="local-6989586621679060934"><span id="local-6989586621679060936"><span class="annot"><span class="annottext">ReadPrec [InteractableState]
ReadPrec InteractableState
Int -&gt; ReadS InteractableState
ReadS [InteractableState]
(Int -&gt; ReadS InteractableState)
-&gt; ReadS [InteractableState]
-&gt; ReadPrec InteractableState
-&gt; ReadPrec [InteractableState]
-&gt; Read InteractableState
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [InteractableState]
$creadListPrec :: ReadPrec [InteractableState]
readPrec :: ReadPrec InteractableState
$creadPrec :: ReadPrec InteractableState
readList :: ReadS [InteractableState]
$creadList :: ReadS [InteractableState]
readsPrec :: Int -&gt; ReadS InteractableState
$creadsPrec :: Int -&gt; ReadS InteractableState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">data</span><span> </span><span id="RoomState"><span class="annot"><a href="GameIO.html#RoomState"><span class="hs-identifier hs-var">RoomState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RoomState"><span class="annot"><a href="GameIO.html#RoomState"><span class="hs-identifier hs-var">RoomState</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-18"></span><span>    </span><span id="interactableStates"><span class="annot"><span class="annottext">RoomState -&gt; [Name]
</span><a href="GameIO.html#interactableStates"><span class="hs-identifier hs-var hs-var">interactableStates</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060900"><span id="local-6989586621679060902"><span id="local-6989586621679060907"><span class="annot"><span class="annottext">Int -&gt; RoomState -&gt; ShowS
[RoomState] -&gt; ShowS
RoomState -&gt; Name
(Int -&gt; RoomState -&gt; ShowS)
-&gt; (RoomState -&gt; Name) -&gt; ([RoomState] -&gt; ShowS) -&gt; Show RoomState
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; Name) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RoomState] -&gt; ShowS
$cshowList :: [RoomState] -&gt; ShowS
show :: RoomState -&gt; Name
$cshow :: RoomState -&gt; Name
showsPrec :: Int -&gt; RoomState -&gt; ShowS
$cshowsPrec :: Int -&gt; RoomState -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060883"><span id="local-6989586621679060892"><span id="local-6989586621679060895"><span id="local-6989586621679060897"><span class="annot"><span class="annottext">ReadPrec [RoomState]
ReadPrec RoomState
Int -&gt; ReadS RoomState
ReadS [RoomState]
(Int -&gt; ReadS RoomState)
-&gt; ReadS [RoomState]
-&gt; ReadPrec RoomState
-&gt; ReadPrec [RoomState]
-&gt; Read RoomState
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [RoomState]
$creadListPrec :: ReadPrec [RoomState]
readPrec :: ReadPrec RoomState
$creadPrec :: ReadPrec RoomState
readList :: ReadS [RoomState]
$creadList :: ReadS [RoomState]
readsPrec :: Int -&gt; ReadS RoomState
$creadsPrec :: Int -&gt; ReadS RoomState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">data</span><span> </span><span id="GameState"><span class="annot"><a href="GameIO.html#GameState"><span class="hs-identifier hs-var">GameState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GameState"><span class="annot"><a href="GameIO.html#GameState"><span class="hs-identifier hs-var">GameState</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span>
</span><span id="line-22"></span><span>    </span><span id="playerState"><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="GameIO.html#playerState"><span class="hs-identifier hs-var hs-var">playerState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-23"></span><span>    </span><span id="commandCountState"><span class="annot"><span class="annottext">GameState -&gt; Int
</span><a href="GameIO.html#commandCountState"><span class="hs-identifier hs-var hs-var">commandCountState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span id="roomStates"><span class="annot"><span class="annottext">GameState -&gt; Map Name RoomState
</span><a href="GameIO.html#roomStates"><span class="hs-identifier hs-var hs-var">roomStates</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="GameIO.html#RoomState"><span class="hs-identifier hs-type">RoomState</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-25"></span><span>    </span><span id="currentRoomStateName"><span class="annot"><span class="annottext">GameState -&gt; Name
</span><a href="GameIO.html#currentRoomStateName"><span class="hs-identifier hs-var hs-var">currentRoomStateName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span id="globalNameStateMap"><span class="annot"><span class="annottext">GameState -&gt; Map Name InteractableState
</span><a href="GameIO.html#globalNameStateMap"><span class="hs-identifier hs-var hs-var">globalNameStateMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="GameIO.html#InteractableState"><span class="hs-identifier hs-type">InteractableState</span></a></span><span> </span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060859"><span id="local-6989586621679060861"><span id="local-6989586621679060873"><span class="annot"><span class="annottext">Int -&gt; GameState -&gt; ShowS
[GameState] -&gt; ShowS
GameState -&gt; Name
(Int -&gt; GameState -&gt; ShowS)
-&gt; (GameState -&gt; Name) -&gt; ([GameState] -&gt; ShowS) -&gt; Show GameState
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; Name) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [GameState] -&gt; ShowS
$cshowList :: [GameState] -&gt; ShowS
show :: GameState -&gt; Name
$cshow :: GameState -&gt; Name
showsPrec :: Int -&gt; GameState -&gt; ShowS
$cshowsPrec :: Int -&gt; GameState -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060827"><span id="local-6989586621679060851"><span id="local-6989586621679060854"><span id="local-6989586621679060856"><span class="annot"><span class="annottext">ReadPrec [GameState]
ReadPrec GameState
Int -&gt; ReadS GameState
ReadS [GameState]
(Int -&gt; ReadS GameState)
-&gt; ReadS [GameState]
-&gt; ReadPrec GameState
-&gt; ReadPrec [GameState]
-&gt; Read GameState
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [GameState]
$creadListPrec :: ReadPrec [GameState]
readPrec :: ReadPrec GameState
$creadPrec :: ReadPrec GameState
readList :: ReadS [GameState]
$creadList :: ReadS [GameState]
readsPrec :: Int -&gt; ReadS GameState
$creadsPrec :: Int -&gt; ReadS GameState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="annot"><a href="GameIO.html#toInteractableState"><span class="hs-identifier hs-type">toInteractableState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Interactable"><span class="hs-identifier hs-type">Interactable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameIO.html#InteractableState"><span class="hs-identifier hs-type">InteractableState</span></a></span><span>
</span><span id="line-30"></span><span id="toInteractableState"><span class="annot"><span class="annottext">toInteractableState :: Interactable -&gt; InteractableState
</span><a href="GameIO.html#toInteractableState"><span class="hs-identifier hs-var hs-var">toInteractableState</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Item"><span class="hs-identifier hs-type">Item</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InteractableState
</span><a href="GameIO.html#ItemState"><span class="hs-identifier hs-var">ItemState</span></a></span><span>
</span><span id="line-31"></span><span class="annot"><a href="GameIO.html#toInteractableState"><span class="hs-identifier hs-var">toInteractableState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><span class="annottext">Desc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060821"><span class="annot"><span class="annottext">Map Name Int
</span><a href="#local-6989586621679060821"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Command]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name Int -&gt; InteractableState
</span><a href="GameIO.html#EntityState"><span class="hs-identifier hs-var">EntityState</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Int
</span><a href="#local-6989586621679060821"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="annot"><a href="GameIO.html#toRoomState"><span class="hs-identifier hs-type">toRoomState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Room"><span class="hs-identifier hs-type">Room</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameIO.html#RoomState"><span class="hs-identifier hs-type">RoomState</span></a></span><span>
</span><span id="line-34"></span><span id="toRoomState"><span class="annot"><span class="annottext">toRoomState :: Room -&gt; RoomState
</span><a href="GameIO.html#toRoomState"><span class="hs-identifier hs-var hs-var">toRoomState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RoomState
</span><a href="GameIO.html#RoomState"><span class="hs-identifier hs-var">RoomState</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; RoomState) -&gt; (Room -&gt; [Name]) -&gt; Room -&gt; RoomState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Room -&gt; [Name]
</span><a href="DataStructures.html#interactables"><span class="hs-identifier hs-var hs-var">interactables</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="annot"><a href="GameIO.html#toGameState"><span class="hs-identifier hs-type">toGameState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Game"><span class="hs-identifier hs-type">Game</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameIO.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span>
</span><span id="line-37"></span><span id="toGameState"><span class="annot"><span class="annottext">toGameState :: Game -&gt; GameState
</span><a href="GameIO.html#toGameState"><span class="hs-identifier hs-var hs-var">toGameState</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Game"><span class="hs-identifier hs-type">Game</span></a></span><span> </span><span id="local-6989586621679060815"><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679060815"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679060814"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679060814"><span class="hs-identifier hs-var">im</span></a></span></span><span> </span><span id="local-6989586621679060813"><span class="annot"><span class="annottext">Desc
</span><a href="#local-6989586621679060813"><span class="hs-identifier hs-var">fm</span></a></span></span><span> </span><span id="local-6989586621679060812"><span class="annot"><span class="annottext">Action ()
</span><a href="#local-6989586621679060812"><span class="hs-identifier hs-var">goe</span></a></span></span><span> </span><span id="local-6989586621679060811"><span class="annot"><span class="annottext">[Command]
</span><a href="#local-6989586621679060811"><span class="hs-identifier hs-var">gr</span></a></span></span><span> </span><span id="local-6989586621679060810"><span class="annot"><span class="annottext">Name -&gt; [Command]
</span><a href="#local-6989586621679060810"><span class="hs-identifier hs-var">gi</span></a></span></span><span> </span><span id="local-6989586621679060809"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060809"><span class="hs-identifier hs-var">ccnt</span></a></span></span><span> </span><span id="local-6989586621679060808"><span class="annot"><span class="annottext">Map Name Room
</span><a href="#local-6989586621679060808"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621679060807"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679060807"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679060806"><span class="annot"><span class="annottext">Map Name Interactable
</span><a href="#local-6989586621679060806"><span class="hs-identifier hs-var">imap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Player
-&gt; Int
-&gt; Map Name RoomState
-&gt; Name
-&gt; Map Name InteractableState
-&gt; GameState
</span><a href="GameIO.html#GameState"><span class="hs-identifier hs-var">GameState</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679060815"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060809"><span class="hs-identifier hs-var">ccnt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Room -&gt; RoomState
</span><a href="GameIO.html#toRoomState"><span class="hs-identifier hs-var">toRoomState</span></a></span><span> </span><span class="annot"><span class="annottext">(Room -&gt; RoomState) -&gt; Map Name Room -&gt; Map Name RoomState
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map Name Room
</span><a href="#local-6989586621679060808"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679060807"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interactable -&gt; InteractableState
</span><a href="GameIO.html#toInteractableState"><span class="hs-identifier hs-var">toInteractableState</span></a></span><span> </span><span class="annot"><span class="annottext">(Interactable -&gt; InteractableState)
-&gt; Map Name Interactable -&gt; Map Name InteractableState
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map Name Interactable
</span><a href="#local-6989586621679060806"><span class="hs-identifier hs-var">imap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="annot"><a href="GameIO.html#setRoomState"><span class="hs-identifier hs-type">setRoomState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameIO.html#RoomState"><span class="hs-identifier hs-type">RoomState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Room"><span class="hs-identifier hs-type">Room</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Room"><span class="hs-identifier hs-type">Room</span></a></span><span>
</span><span id="line-40"></span><span id="setRoomState"><span class="annot"><span class="annottext">setRoomState :: Name -&gt; RoomState -&gt; Room -&gt; Room
</span><a href="GameIO.html#setRoomState"><span class="hs-identifier hs-var hs-var">setRoomState</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameIO.html#RoomState"><span class="hs-identifier hs-type">RoomState</span></a></span><span> </span><span id="local-6989586621679060803"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679060803"><span class="hs-identifier hs-var">ists</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Room"><span class="hs-identifier hs-type">Room</span></a></span><span> </span><span id="local-6989586621679060801"><span class="annot"><span class="annottext">Desc
</span><a href="#local-6989586621679060801"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679060800"><span class="annot"><span class="annottext">Action ()
</span><a href="#local-6989586621679060800"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060799"><span class="annot"><span class="annottext">[Command]
</span><a href="#local-6989586621679060799"><span class="hs-identifier hs-var">rcmds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Desc -&gt; Action () -&gt; [Name] -&gt; [Command] -&gt; Room
</span><a href="DataStructures.html#Room"><span class="hs-identifier hs-var">Room</span></a></span><span> </span><span class="annot"><span class="annottext">Desc
</span><a href="#local-6989586621679060801"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Action ()
</span><a href="#local-6989586621679060800"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679060803"><span class="hs-identifier hs-var">ists</span></a></span><span> </span><span class="annot"><span class="annottext">[Command]
</span><a href="#local-6989586621679060799"><span class="hs-identifier hs-var">rcmds</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="annot"><a href="GameIO.html#setRoomStates"><span class="hs-identifier hs-type">setRoomStates</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="GameIO.html#RoomState"><span class="hs-identifier hs-type">RoomState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="DataStructures.html#Room"><span class="hs-identifier hs-type">Room</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="DataStructures.html#Room"><span class="hs-identifier hs-type">Room</span></a></span><span>
</span><span id="line-43"></span><span id="setRoomStates"><span class="annot"><span class="annottext">setRoomStates :: Map Name RoomState -&gt; Map Name Room -&gt; Map Name Room
</span><a href="GameIO.html#setRoomStates"><span class="hs-identifier hs-var hs-var">setRoomStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimpleWhenMissing Name RoomState Room
-&gt; SimpleWhenMissing Name Room Room
-&gt; SimpleWhenMatched Name RoomState Room Room
-&gt; Map Name RoomState
-&gt; Map Name Room
-&gt; Map Name Room
forall k a c b.
Ord k =&gt;
SimpleWhenMissing k a c
-&gt; SimpleWhenMissing k b c
-&gt; SimpleWhenMatched k a b c
-&gt; Map k a
-&gt; Map k b
-&gt; Map k c
</span><span class="hs-identifier hs-var">M.merge</span></span><span> </span><span class="annot"><span class="annottext">SimpleWhenMissing Name RoomState Room
forall (f :: * -&gt; *) k x y. Applicative f =&gt; WhenMissing f k x y
</span><span class="hs-identifier hs-var">M.dropMissing</span></span><span> </span><span class="annot"><span class="annottext">SimpleWhenMissing Name Room Room
forall (f :: * -&gt; *) k x y. Applicative f =&gt; WhenMissing f k x y
</span><span class="hs-identifier hs-var">M.dropMissing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; RoomState -&gt; Room -&gt; Room)
-&gt; SimpleWhenMatched Name RoomState Room Room
forall (f :: * -&gt; *) k x y z.
Applicative f =&gt;
(k -&gt; x -&gt; y -&gt; z) -&gt; WhenMatched f k x y z
</span><span class="hs-identifier hs-var">M.zipWithMatched</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; RoomState -&gt; Room -&gt; Room
</span><a href="GameIO.html#setRoomState"><span class="hs-identifier hs-var">setRoomState</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="annot"><a href="GameIO.html#setInteractableState"><span class="hs-identifier hs-type">setInteractableState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameIO.html#InteractableState"><span class="hs-identifier hs-type">InteractableState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Interactable"><span class="hs-identifier hs-type">Interactable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Interactable"><span class="hs-identifier hs-type">Interactable</span></a></span><span>
</span><span id="line-46"></span><span id="setInteractableState"><span class="annot"><span class="annottext">setInteractableState :: Name -&gt; InteractableState -&gt; Interactable -&gt; Interactable
</span><a href="GameIO.html#setInteractableState"><span class="hs-identifier hs-var hs-var">setInteractableState</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InteractableState
</span><a href="GameIO.html#ItemState"><span class="hs-identifier hs-var">ItemState</span></a></span><span> </span><span id="local-6989586621679060793"><span class="annot"><span class="annottext">i :: Interactable
</span><a href="#local-6989586621679060793"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Item"><span class="hs-identifier hs-type">Item</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Interactable
</span><a href="#local-6989586621679060793"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-47"></span><span class="annot"><a href="GameIO.html#setInteractableState"><span class="hs-identifier hs-var">setInteractableState</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameIO.html#EntityState"><span class="hs-identifier hs-type">EntityState</span></a></span><span> </span><span id="local-6989586621679060792"><span class="annot"><span class="annottext">Map Name Int
</span><a href="#local-6989586621679060792"><span class="hs-identifier hs-var">params</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span id="local-6989586621679060791"><span class="annot"><span class="annottext">Desc
</span><a href="#local-6989586621679060791"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map Name Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060790"><span class="annot"><span class="annottext">[Command]
</span><a href="#local-6989586621679060790"><span class="hs-identifier hs-var">cmds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Desc -&gt; Map Name Int -&gt; [Command] -&gt; Interactable
</span><a href="DataStructures.html#Entity"><span class="hs-identifier hs-var">Entity</span></a></span><span> </span><span class="annot"><span class="annottext">Desc
</span><a href="#local-6989586621679060791"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Int
</span><a href="#local-6989586621679060792"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">[Command]
</span><a href="#local-6989586621679060790"><span class="hs-identifier hs-var">cmds</span></a></span><span>
</span><span id="line-48"></span><span class="annot"><a href="GameIO.html#setInteractableState"><span class="hs-identifier hs-var">setInteractableState</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InteractableState
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Interactable
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Interactable
</span><a href="DataStructures.html#Invalid"><span class="hs-identifier hs-var">Invalid</span></a></span><span> </span><span class="hs-comment">-- unmatched types</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="annot"><a href="GameIO.html#setInteractableStates"><span class="hs-identifier hs-type">setInteractableStates</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="GameIO.html#InteractableState"><span class="hs-identifier hs-type">InteractableState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="DataStructures.html#Interactable"><span class="hs-identifier hs-type">Interactable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="DataStructures.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="DataStructures.html#Interactable"><span class="hs-identifier hs-type">Interactable</span></a></span><span>
</span><span id="line-51"></span><span id="setInteractableStates"><span class="annot"><span class="annottext">setInteractableStates :: Map Name InteractableState
-&gt; Map Name Interactable -&gt; Map Name Interactable
</span><a href="GameIO.html#setInteractableStates"><span class="hs-identifier hs-var hs-var">setInteractableStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimpleWhenMissing Name InteractableState Interactable
-&gt; SimpleWhenMissing Name Interactable Interactable
-&gt; SimpleWhenMatched
     Name InteractableState Interactable Interactable
-&gt; Map Name InteractableState
-&gt; Map Name Interactable
-&gt; Map Name Interactable
forall k a c b.
Ord k =&gt;
SimpleWhenMissing k a c
-&gt; SimpleWhenMissing k b c
-&gt; SimpleWhenMatched k a b c
-&gt; Map k a
-&gt; Map k b
-&gt; Map k c
</span><span class="hs-identifier hs-var">M.merge</span></span><span> </span><span class="annot"><span class="annottext">SimpleWhenMissing Name InteractableState Interactable
forall (f :: * -&gt; *) k x y. Applicative f =&gt; WhenMissing f k x y
</span><span class="hs-identifier hs-var">M.dropMissing</span></span><span> </span><span class="annot"><span class="annottext">SimpleWhenMissing Name Interactable Interactable
forall (f :: * -&gt; *) k x y. Applicative f =&gt; WhenMissing f k x y
</span><span class="hs-identifier hs-var">M.dropMissing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; InteractableState -&gt; Interactable -&gt; Interactable)
-&gt; SimpleWhenMatched
     Name InteractableState Interactable Interactable
forall (f :: * -&gt; *) k x y z.
Applicative f =&gt;
(k -&gt; x -&gt; y -&gt; z) -&gt; WhenMatched f k x y z
</span><span class="hs-identifier hs-var">M.zipWithMatched</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; InteractableState -&gt; Interactable -&gt; Interactable
</span><a href="GameIO.html#setInteractableState"><span class="hs-identifier hs-var">setInteractableState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="annot"><a href="GameIO.html#setGameState"><span class="hs-identifier hs-type">setGameState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameIO.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Game"><span class="hs-identifier hs-type">Game</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Game"><span class="hs-identifier hs-type">Game</span></a></span><span>
</span><span id="line-54"></span><span id="setGameState"><span class="annot"><span class="annottext">setGameState :: GameState -&gt; Game -&gt; Game
</span><a href="GameIO.html#setGameState"><span class="hs-identifier hs-var hs-var">setGameState</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameIO.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span id="local-6989586621679060786"><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679060786"><span class="hs-identifier hs-var">pst</span></a></span></span><span> </span><span id="local-6989586621679060785"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060785"><span class="hs-identifier hs-var">ccnt</span></a></span></span><span> </span><span id="local-6989586621679060784"><span class="annot"><span class="annottext">Map Name RoomState
</span><a href="#local-6989586621679060784"><span class="hs-identifier hs-var">rsts</span></a></span></span><span> </span><span id="local-6989586621679060783"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679060783"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679060782"><span class="annot"><span class="annottext">Map Name InteractableState
</span><a href="#local-6989586621679060782"><span class="hs-identifier hs-var">istmap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataStructures.html#Game"><span class="hs-identifier hs-type">Game</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060781"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679060781"><span class="hs-identifier hs-var">im</span></a></span></span><span> </span><span id="local-6989586621679060780"><span class="annot"><span class="annottext">Desc
</span><a href="#local-6989586621679060780"><span class="hs-identifier hs-var">fm</span></a></span></span><span> </span><span id="local-6989586621679060779"><span class="annot"><span class="annottext">Action ()
</span><a href="#local-6989586621679060779"><span class="hs-identifier hs-var">goe</span></a></span></span><span> </span><span id="local-6989586621679060778"><span class="annot"><span class="annottext">[Command]
</span><a href="#local-6989586621679060778"><span class="hs-identifier hs-var">gr</span></a></span></span><span> </span><span id="local-6989586621679060777"><span class="annot"><span class="annottext">Name -&gt; [Command]
</span><a href="#local-6989586621679060777"><span class="hs-identifier hs-var">gi</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060776"><span class="annot"><span class="annottext">Map Name Room
</span><a href="#local-6989586621679060776"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060775"><span class="annot"><span class="annottext">Map Name Interactable
</span><a href="#local-6989586621679060775"><span class="hs-identifier hs-var">imap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Player
-&gt; Name
-&gt; Desc
-&gt; Action ()
-&gt; [Command]
-&gt; (Name -&gt; [Command])
-&gt; Int
-&gt; Map Name Room
-&gt; Name
-&gt; Map Name Interactable
-&gt; Game
</span><a href="DataStructures.html#Game"><span class="hs-identifier hs-var">Game</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679060786"><span class="hs-identifier hs-var">pst</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679060781"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">Desc
</span><a href="#local-6989586621679060780"><span class="hs-identifier hs-var">fm</span></a></span><span> </span><span class="annot"><span class="annottext">Action ()
</span><a href="#local-6989586621679060779"><span class="hs-identifier hs-var">goe</span></a></span><span> </span><span class="annot"><span class="annottext">[Command]
</span><a href="#local-6989586621679060778"><span class="hs-identifier hs-var">gr</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Command]
</span><a href="#local-6989586621679060777"><span class="hs-identifier hs-var">gi</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060785"><span class="hs-identifier hs-var">ccnt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name RoomState -&gt; Map Name Room -&gt; Map Name Room
</span><a href="GameIO.html#setRoomStates"><span class="hs-identifier hs-var">setRoomStates</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name RoomState
</span><a href="#local-6989586621679060784"><span class="hs-identifier hs-var">rsts</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Room
</span><a href="#local-6989586621679060776"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679060783"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name InteractableState
-&gt; Map Name Interactable -&gt; Map Name Interactable
</span><a href="GameIO.html#setInteractableStates"><span class="hs-identifier hs-var">setInteractableStates</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name InteractableState
</span><a href="#local-6989586621679060782"><span class="hs-identifier hs-var">istmap</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Interactable
</span><a href="#local-6989586621679060775"><span class="hs-identifier hs-var">imap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="annot"><a href="GameIO.html#exportGameStateToFile"><span class="hs-identifier hs-type">exportGameStateToFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataStructures.html#Game"><span class="hs-identifier hs-type">Game</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span id="exportGameStateToFile"><span class="annot"><span class="annottext">exportGameStateToFile :: Name -&gt; Game -&gt; IO ()
</span><a href="GameIO.html#exportGameStateToFile"><span class="hs-identifier hs-var hs-var">exportGameStateToFile</span></a></span></span><span> </span><span id="local-6989586621679060772"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679060772"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679060771"><span class="annot"><span class="annottext">Game
</span><a href="#local-6989586621679060771"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; IO ()
</span><span class="hs-identifier hs-var">writeFile</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679060772"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; IO ()) -&gt; Name -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Name
forall a. Show a =&gt; a -&gt; Name
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; Name) -&gt; GameState -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Game -&gt; GameState
</span><a href="GameIO.html#toGameState"><span class="hs-identifier hs-var">toGameState</span></a></span><span> </span><span class="annot"><span class="annottext">Game
</span><a href="#local-6989586621679060771"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="annot"><a href="GameIO.html#importGameStateFromFile"><span class="hs-identifier hs-type">importGameStateFromFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GameIO.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span id="importGameStateFromFile"><span class="annot"><span class="annottext">importGameStateFromFile :: Name -&gt; IO (Maybe GameState)
</span><a href="GameIO.html#importGameStateFromFile"><span class="hs-identifier hs-var hs-var">importGameStateFromFile</span></a></span></span><span> </span><span id="local-6989586621679060767"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679060767"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe GameState
forall a. Read a =&gt; Name -&gt; Maybe a
</span><span class="hs-identifier hs-var">readMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Maybe GameState) -&gt; IO Name -&gt; IO (Maybe GameState)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; IO Name
</span><span class="hs-identifier hs-var">readFile</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679060767"><span class="hs-identifier hs-var">fp</span></a></span></pre></body></html>